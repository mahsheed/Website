<!doctype html>
<html>
  <head>
    <title> </title>
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
  </head>
  <body>
    <h1>Shopping Cart</h1>

    <div>
      <ul>
        <li><a class="add-to-cart" href="#" data-name="Apple" data-price="1.22">Apple $1.22</a></li>
        <li><a class="add-to-cart" href="#" data-name="Banana" data-price="1.33">Banana $1.33</a></li>
        <li><a class="add-to-cart" href="#" data-name="Shoe" data-price="22.33">Shoe $22.33</a></li>
        <li><a class="add-to-cart" href="#" data-name="Frisbee" data-price="5.22">Frisbee $5.22</a></li>
      </ul>
      <button id="clear-cart">Clear Cart</button>
    </div>


    <div>
      <ul id="show-cart">
        <li>??????</li>
      </ul>
      <div>Total Cart:$<span id="total-cart"></span></div>
    </div>

    <script>

      $(".add-to-cart").click(function(event){
        event.preventDefault();
        var name = $(this).attr("data-name");
        var price = Number($(this).attr("data-price"));

        addItemToCart(name, price, 1);
        displayCart();
      });

      $("#clear-cart").click(function(event){
        clearCart();
        displayCart();
      });

      function displayCart() {
        var cartArray= listCart ();
        var output = "";

        for (var i in cartArray) {
          output += "<li>"+cartArray[i].name
            +" "+cartArray[i].count
            +" x "+cartArray[i].price
            +" = "+cartArray[i].total+"</li>"; //+= means add to the end of what's alraedy there
        }

        $("#show-cart").html(output); //lets you write text into tag
        $("total-cart").html( totalCart() );
      }

      //*******************************
      // Shopping Cart functions

      var cart = [];

      var Item = function(name, price, count) {
          this.name = name
          this.price = price
          this.count = count
      };

      function addItemToCart(name, price, count) {
        for (var i in cart) {
          if (cart[i].name === name) {
              cart[i].count += count;
              saveCart();
              return;
          }
        }
        var item = new Item(name, price, count);
        cart.push(item);
        saveCart();
      }

      function removeItemFromCart(name) { //Removes one item}
        for (var i in cart) {
            if (cart[i].name === name) { //"3" === 3 false
                cart[i].count --; //cart[i].count --
                if (cart[i].count === 0) {
                  cart.splice(i, 1);
                }
                break; 
          }
        }
        saveCart();
      }
      
      function removeItemFromCartAll(name) {// removes all item name
        for (var i in cart) {
          if (cart[i].name === name) {
              cart.splice(i, 1);
              break;
           }
        }
        saveCart();
      }

      function clearCart() {
        cart = [];
        saveCart();
      }

      function countCart() { // -> return total count
        var totalCount = 0;
        for (var i in cart) {
          totalCount += cart[i].count;
        }

        return totalCount;
      }
      
      function totalCart() { // -> return total cost
        var totalCost = 0;
        for (var i in cart) {
          totalCost += cart[i].price * cart[i].count;
        }
        return totalCost.toFixed(2);
      }

      function listCart() { //-> array of Item
        var cartCopy = [];
        for (var i in cart) {
          var item = cart[i];
          var itemCopy = {};
          for (var p in item) {
            itemCopy[p] = item[p];
          }
          itemCopy.total= item.price * item.count;
          cartCopy.push(itemCopy);
        }
        return cartCopy;
      }

      function saveCart() {
        localStorage.setItem("shoppingCart", JSON.stringify(cart)); //jason turned it into string
      } 

      function loadCart() {
        cart = JSON.parse(localStorage.getItem("shoppingCart"));
      }

      loadCart();
      displayCart(); //must display after you load the cart.

    </script>
  </body>
</html>